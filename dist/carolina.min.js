"use strict";!function(n){function e(){return!!b.ran||(i("error","You must initailzied carolina.js `carolina.init(options)`."),!1)}function t(n,e){return"undefiend"==typeof b[n]?void i("error","You cannot set to not exist property a value."):(i("debug","Setting new value for "+n+" => ",e),b[n]=e,this)}function i(n,e){if("function"!=typeof console[n])return void console.error("Trying to you console log with unknown console type => ",n);if("debug"!==n||b.isDebug){for(var t=arguments.length,i=Array(t>2?t-2:0),o=2;o<t;o++)i[o-2]=arguments[o];if(Array.isArray(i)&&i.length>0)return void console[n]("CAROLINA::"+e,i);console[n]("CAROLINA::"+e)}}function o(n){return n.SpeechRecognition||n.webkitSpeechRecognition||n.mozSpeechRecognition||n.msSpeechRecognition||n.oSpeechRecognition}function r(e){if(b.rec)return void i("error","You cannot initialized the webkit speech recognition twice!, you should kill the current instance and initialized again.");b.rec=new(o(n)),b.rec.lang=e.lang,b.rec.continuous=e.continuous,b.rec.interimResults=e.interimResults,b.rec.maxAlternatives=e.maxAlternatives,b.rec.onstart=a,b.rec.onresult=s,b.rec.onerror=u,b.rec.onend=l,b.rec.onnomatch=g,b.rec.onsoundstart=d,b.rec.onsoundend=f,b.rec.onspeechstart=p,b.rec.onspeechend=h}function c(n){var e=b.options.callbacks;if(!e)return void i("debug","There is no configured callbacks!");if(!e[n])return void i("debug","There is no callback configured for callback name => ",n);for(var t=arguments.length,o=Array(t>1?t-1:0),r=1;r<t;r++)o[r-1]=arguments[r];e[n].apply(e.context,o)}function s(n){var e="",o=new D(C);o.start(),t("lastTranscriptSentence",b.finalTranscript);for(var r=n.resultIndex;r<n.results.length;++r){var s=n.results[r][0].transcript,a=n.results[r][0].confidence;if(b.options.quality!==Math.round(a))return i("debug","The transcript we capture from speaking is not confidence enough due to your quality restrictions => ",s),void c(L,s);n.results[r].isFinal?(i("debug","Recevied new chunk transcript from user speaking text value & confidence => ",s,a),c(k,s)):(e+=s,i("debug","Interim transcript current speaking value => ",e),c(T,e))}t("finalTranscript",b.finalTranscript+s),i("debug","Live stream of transcript => ",b.finalTranscript),c(S,b.finalTranscript),o.end()}function a(){t("isListening",!0),i("debug","Start listening... "),c(v)}function u(n){t("errorCount",b.errorCount++),t("isListening",!1),i("error","An error been occured => ",n),c(y,n)}function l(n){t("isListening",!1),t("finalTranscript",""),i("info","Stop listening... "),c(m,n)}function d(n){i("debug","Sound recognisable speech or not has been detected"),c(w,n)}function g(n){i("debug","Speech recognition service returns a final result with no significant recognition. This may involve some degree of recognition, which doesnt meet or exceed the confidence threshold."),c(A,n)}function f(n){i("debug","Any sound recognisable speech or not has stopped being detected."),c(R,n)}function p(n){i("debug","A sound that is recognised by the speech recognition service as speech has been detected."),c(O,n)}function h(n){i("debug","Speech recognised by the speech recognition service has stopped being detected."),c(x,n)}if(!o(n))return void i("warn","Your browser is not support webkit speech recognition!.");var b={rec:null,ran:!1,options:{toString:function(){var n="\n";return Object.keys(this).map(function(e,t,i){"toString"!==e&&(n+=e+" => "+this[e],t!==i.length-1&&(n+="\n"))}.bind(this)),n}},isDebug:!1,errorCount:0,isListening:!1,finalTranscript:"",lastTranscriptSentence:"",version:"1.0.0"},v="onStart",m="onEnd",y="onError",S="onLiveStream",k="onChunkStream",T="onInterimTranscript",w="onSoundStart",A="onNoMatch",R="onSoundEnd",O="onSpeechStart",x="onSpeechEnd",L="onBadQuality",C="ON_RESULT",D=function(n){var e,t;return{start:function(){e=new Date},end:function(){t=new Date;var o=t.getTime()-e.getTime();i("debug",n+" took "+o+" ms to execute")}}},Y={start:function(){b.rec.start()},abort:function(){b.rec.abort()},stop:function(){b.rec.stop()},clearStream:function(){t("finalTranscript","")},lastSentence:function(){return b.lastTranscriptSentence},doctor:function(){i("info","Voice recognition status ver: "+b.version+"\ndebug mode is "+(b.isDebug?"ON":"OFF")+" \nconfiguration details are: "+b.options.toString()+"\nlibrary health condition "+(b.errorCount>3?"POOR":"GOOD")+"\nquality of speaking "+(1===b.options.quality?"GOOD":"POOR"))},isListening:function(){return b.isListening}};n.Carolina={init:function(n){if(b.ran)return void i("error","You can init only once");b.ran=!0,b.options=Object.assign({},b.options,{lang:n.lang||"en-US",debug:n.debug||!1,quality:n.quality||1,continuous:n.continuous||!1,interimResults:n.interimResults||!1,maxAlternatives:n.maxAlternatives||1,callbacks:n.callbacks}),b.isDebug="boolean"==typeof n.debug&&n.debug,r({lang:b.options.lang,continuous:b.options.continuous,interimResults:b.options.interimResults,maxAlternatives:b.options.maxAlternatives})},fn:function(n){if(e()){if("function"!=typeof Y[n])return void i("error","You try to invoke invalid method => ",n);var t;try{for(var o=arguments.length,r=Array(o>1?o-1:0),c=1;c<o;c++)r[c-1]=arguments[c];t=Y[n].apply(this,r)}catch(n){i("error","You have been encounter api function exception => ",n)}return t}}}}(window);